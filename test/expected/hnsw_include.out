CREATE TABLE small_world (
    id int,
    b BOOLEAN,
    v REAL[3]
);
CREATE INDEX test ON small_world USING hnsw (v) INCLUDE (id, b) WITH (dim=3, M=5);
INFO:  done init usearch index
INFO:  inserted 0 elements
INFO:  done saving 0 vectors
INSERT INTO small_world (id, b, v) VALUES
    (1, TRUE,  '{0,0,0}'),
    (2, TRUE,  '{0,0,1}'),
    (3, FALSE, '{0,1,0}'),
    (4, TRUE,  '{0,1,1}'),
    (5, FALSE, '{1,0,0}'),
    (6, FALSE, '{1,0,1}'),
    (7, FALSE, '{1,1,0}'),
    (8, TRUE,  '{1,1,1}');
SET enable_seqscan = off;
EXPLAIN (COSTS FALSE) SELECT * FROM small_world ORDER BY v <-> '{1,1,1}' ASC;
                QUERY PLAN                 
-------------------------------------------
 Index Only Scan using test on small_world
   Order By: (v <-> '{1,1,1}'::real[])
(2 rows)

-- TODO this works but row ordering is non deterministic and a second order by forces seq scan
-- SELECT n, v FROM small_world ORDER BY v <-> '{1,1,1}' ASC;
DROP TABLE small_world;
CREATE TABLE small_world (
    id int,
    b BOOLEAN,
    v REAL[3]
);
INSERT INTO small_world (id, b, v) VALUES
    (1, TRUE,  '{0,0,0}'),
    (2, TRUE,  '{0,0,1}'),
    (3, FALSE, '{0,1,0}'),
    (4, TRUE,  '{0,1,1}'),
    (5, FALSE, '{1,0,0}'),
    (6, FALSE, '{1,0,1}'),
    (7, FALSE, '{1,1,0}'),
    (8, TRUE,  '{1,1,1}');
CREATE INDEX test ON small_world USING hnsw (v) INCLUDE (b) WITH (dim=3, M=5);
INFO:  done init usearch index
INFO:  inserted 8 elements
INFO:  done saving 8 vectors
EXPLAIN (COSTS FALSE) SELECT * FROM small_world ORDER BY v <-> '{1,1,1}' ASC;
              QUERY PLAN               
---------------------------------------
 Index Scan using test on small_world
   Order By: (v <-> '{1,1,1}'::real[])
(2 rows)

EXPLAIN (COSTS FALSE) SELECT b,v FROM small_world ORDER BY v <-> '{1,1,1}' ASC;
                QUERY PLAN                 
-------------------------------------------
 Index Only Scan using test on small_world
   Order By: (v <-> '{1,1,1}'::real[])
(2 rows)

SELECT b,v FROM small_world ORDER BY v <-> '{1,1,1}' ASC;
 b |    v    
---+---------
 t | {1,1,1}
 t | {0,1,1}
 f | {1,0,1}
 f | {1,1,0}
 t | {0,0,1}
 f | {0,1,0}
 f | {1,0,0}
 t | {0,0,0}
(8 rows)

-- TODO add test for when included columns exceed page size
